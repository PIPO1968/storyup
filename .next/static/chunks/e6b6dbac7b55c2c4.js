(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59470,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.s(["default",0,({userGrade:s,userSchool:r})=>{let[o,i]=a.default.useState(""),[l,n]=a.default.useState(""),[d,u]=a.default.useState(""),[c,m]=a.default.useState(""),[p,g]=a.default.useState([]),[f,x]=a.default.useState(300),[h,j]=a.default.useState(!1);a.default.useEffect(()=>{if(!o||h)return;if(0===f){j(!0),m("â° Tiempo agotado. No puedes responder esta pregunta. -3 likes");return}let e=setTimeout(()=>x(f-1),1e3);return()=>clearTimeout(e)},[f,o,h]);let S=[];try{S=e.f({"../questions/campeonato-1primaria.json":{id:()=>5251,module:()=>e.r(5251)},"../questions/campeonato-2primaria.json":{id:()=>31668,module:()=>e.r(31668)},"../questions/campeonato-3primaria.json":{id:()=>85700,module:()=>e.r(85700)},"../questions/campeonato-4primaria.json":{id:()=>8433,module:()=>e.r(8433)},"../questions/campeonato-5primaria.json":{id:()=>59447,module:()=>e.r(59447)},"../questions/campeonato-6primaria.json":{id:()=>6959,module:()=>e.r(6959)}})(`../questions/campeonato-${s}primaria.json`)}catch{S=[]}return(0,t.jsxs)("div",{className:"p-4 bg-yellow-100 rounded-lg",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Modo Campeonato"}),(0,t.jsxs)("p",{children:["Curso seleccionado: ",s,"Âº Primaria"]}),(0,t.jsxs)("p",{children:["Centro escolar: ",r||"No especificado"]}),(0,t.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mt-2",onClick:function(){if(p.length>=25){i(""),n(""),m("Â¡Has completado las 25 preguntas del campeonato!"),j(!0);let e=localStorage.getItem("user"),t="",a="",s="";if(e){let r=JSON.parse(e);t=r.nick,a=r.centro,s=r.curso}let r=localStorage.getItem(`respuestas_campeonato_${t}`),o=r?JSON.parse(r):[],l=o.filter(e=>e.correcta).length,d=o.filter(e=>!e.correcta).length,u=o.reduce((e,t)=>e+(t.likes||0),0),c=new Date,p=c.getFullYear();c.getMonth()+1>=10&&(p+=1);let g=`t${p}`,f=+(l>12),x=`campeonato_individual_${g}`,h={};try{h=JSON.parse(localStorage.getItem(x)||"{}")}catch{h={}}let S=l,b=d,N=u,y=f,v=+(l<=12);if(h[t]&&(S+=h[t].acertadas||0,b+=h[t].falladas||0,N+=h[t].likes||0,y+=h[t].ganado||0,v+=h[t].perdido||0),e){let r=JSON.parse(e);if(h[t]={centro:a,curso:s,acertadas:S,falladas:b,likes:N,ganado:y,perdido:v,fecha:c.toISOString()},localStorage.setItem(x,JSON.stringify(h)),1===f){r.competicionesSuperadas=(r.competicionesSuperadas||0)+1,localStorage.setItem("user",JSON.stringify(r));let e=[];try{e=JSON.parse(localStorage.getItem("users")||"[]")}catch{e=[]}let t=(r.nick||"").toLowerCase().replace(/\s+/g,""),a=!1;e=e.map(e=>(e.nick||"").toLowerCase().replace(/\s+/g,"")===t?(a=!0,{...e,...r}):e),a||e.push(r),localStorage.setItem("users",JSON.stringify(e)),window.dispatchEvent(new Event("profileUpdate")),window.dispatchEvent(new Event("storage"))}}let q=`campeonato_centros_${g}`,k={};try{k=JSON.parse(localStorage.getItem(q)||"{}")}catch{k={}}a&&(k[a]||(k[a]={ganados:0,perdidos:0,preguntasAcertadas:0,preguntasFalladas:0,likes:0}),k[a].ganados+=y,k[a].perdidos+=v,k[a].preguntasAcertadas+=S,k[a].preguntasFalladas+=b,k[a].likes+=N),localStorage.setItem(q,JSON.stringify(k));let w=`campeonato_docentes_${g}`,I={};try{I=JSON.parse(localStorage.getItem(w)||"{}")}catch{I={}}if(e){let t=JSON.parse(e);if("Docente"===t.tipo){let e=(t.nick||"").toLowerCase().replace(/\s+/g,"");I[e]||(I[e]={ganados:0,perdidos:0,preguntasAcertadas:0,preguntasFalladas:0,likes:0}),I[e].ganados+=y,I[e].perdidos+=v,I[e].preguntasAcertadas+=S,I[e].preguntasFalladas+=b,I[e].likes+=N}}if(localStorage.setItem(w,JSON.stringify(I)),e){let t=JSON.parse(e);t.ganados=(t.ganados||0)+y,t.perdidos=(t.perdidos||0)+v,t.respuestasAcertadas=(t.respuestasAcertadas||0)+S,t.preguntasFalladas=(t.preguntasFalladas||0)+b,t.likes=(t.likes||0)+N,localStorage.setItem("user",JSON.stringify(t));let a=[];try{a=JSON.parse(localStorage.getItem("users")||"[]")}catch{a=[]}let s=(t.nick||"").toLowerCase().replace(/\s+/g,""),r=!1;a=a.map(e=>(e.nick||"").toLowerCase().replace(/\s+/g,"")===s?(r=!0,{...e,...t}):e),r||a.push(t),localStorage.setItem("users",JSON.stringify(a))}return}x(300),j(!1);let e=S.filter(e=>!p.includes(e.pregunta));if(0===e.length){i(""),n(""),m("Â¡No hay mÃ¡s preguntas disponibles en el banco!"),j(!0);return}let t=Math.floor(Math.random()*e.length);i(e[t].pregunta),n(e[t].respuesta),u(""),m(""),g([...p,e[t].pregunta])},children:"Generar pregunta de campeonato"}),o&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("div",{className:"font-semibold mb-2",children:o}),(0,t.jsxs)("div",{className:"font-bold text-lg mb-2",children:["â° Tiempo: ",Math.floor(f/60),":",(f%60).toString().padStart(2,"0")," min"]}),(0,t.jsx)("input",{type:"text",className:"border rounded px-2 py-1 w-full mb-2",value:d,onChange:e=>u(e.target.value),placeholder:"Escribe tu respuesta aquÃ­",disabled:h}),(0,t.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded",onClick:function(){function e(e){return e.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g,"").trim()}if(h)return;let t=e(d)===e(l);j(!0);let a=0;t?(m("Â¡Correcto! ðŸŽ‰"),a=f>120?2:1):(m(`Incorrecto. La respuesta era: ${l}`),a=f>120?-1:-2);{let e=localStorage.getItem("user");if(e){let s=JSON.parse(e);s.likes=(s.likes||0)+a,localStorage.setItem("user",JSON.stringify(s));let r=`respuestas_campeonato_${s.nick}`,i=[];try{i=JSON.parse(localStorage.getItem(r)||"[]")}catch{i=[]}i.push({pregunta:o,respuestaUsuario:d,respuestaCorrecta:l,correcta:t,tiempo:f,likes:a}),localStorage.setItem(r,JSON.stringify(i))}}},disabled:h,children:"Enviar respuesta"}),c&&(0,t.jsx)("div",{className:"mt-2 font-bold",children:c})]}),c&&!o&&(0,t.jsx)("div",{className:"mt-2 font-bold text-red-600",children:c})]})}])},96938,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(59470);let r=({userGrade:s,onTournamentComplete:r})=>{let o,[i,l]=a.default.useState(""),[n,d]=a.default.useState(null),[u,c]=a.default.useState(""),[m,p]=a.default.useState(""),[g,f]=a.default.useState(""),[x,h]=a.default.useState([]),[j,S]=a.default.useState(300),[b,N]=a.default.useState(!1),[y,v]=a.default.useState(0),[q,k]=a.default.useState(0),[w,I]=a.default.useState(1);a.default.useEffect(()=>{if(!i||b)return;if(0===j){N(!0),k(q-15),f("â° Tiempo agotado. -15 puntos");return}let e=setTimeout(()=>S(j-1),1e3);return()=>clearTimeout(e)},[j,i,b,q]);let O=[];try{O=e.f({"../questions/general-1primaria.json":{id:()=>83772,module:()=>e.r(83772)},"../questions/general-2primaria.json":{id:()=>13725,module:()=>e.r(13725)},"../questions/general-3primaria.json":{id:()=>98958,module:()=>e.r(98958)},"../questions/general-4primaria.json":{id:()=>83846,module:()=>e.r(83846)},"../questions/general-5primaria.json":{id:()=>60450,module:()=>e.r(60450)},"../questions/general-6primaria.json":{id:()=>31390,module:()=>e.r(31390)}})(`../questions/general-${s}primaria.json`)}catch{O=[]}function C(){if(x.length>=25)return void r(y,q);if(0===O.length){l("No hay preguntas disponibles para este curso."),N(!0);return}let e=O.filter(e=>!x.includes(e.pregunta));if(0===e.length){let e=Math.floor(Math.random()*O.length),t=O[e];l(t.pregunta),d(t),c(t.respuesta_correcta),p(""),f(""),S(300),N(!1),I(w+1);return}let t=Math.floor(Math.random()*e.length),a=e[t];l(a.pregunta),d(a),c(a.respuesta_correcta),p(""),f(""),S(300),N(!1),I(w+1),h([...x,a.pregunta])}function J(){if(b)return;let e=300-j,t=0;m.toLowerCase().trim()===u.toLowerCase().trim()?(v(y+1),e<=60?(t=10,f("âœ… Â¡Correcto! +10 puntos (rÃ¡pido)")):(t=5,f("âœ… Â¡Correcto! +5 puntos"))):e<=60?(t=-5,f(`âŒ Incorrecto. -5 puntos
La respuesta correcta era: ${u}`)):(t=-10,f(`âŒ Incorrecto. -10 puntos
La respuesta correcta era: ${u}`)),k(q+t),N(!0)}return(a.default.useEffect(()=>{O.length>0&&!i&&C()},[O]),x.length>=25)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 text-center max-w-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"ðŸŽ¯ Â¡Torneo Completado!"}),(0,t.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ†"}),(0,t.jsxs)("p",{className:"text-lg mb-2",children:["Aciertos: ",(0,t.jsxs)("strong",{children:[y,"/25"]})]}),(0,t.jsxs)("p",{className:"text-lg mb-2",children:["PuntuaciÃ³n total: ",(0,t.jsxs)("strong",{children:[q," puntos"]})]}),(0,t.jsxs)("p",{className:"text-lg",children:["Promedio: ",(0,t.jsxs)("strong",{children:[(q/25).toFixed(1)," pts/pregunta"]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-4",children:"Los resultados se procesarÃ¡n automÃ¡ticamente..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 p-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-6 mb-6 text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"ðŸŽ¯ Modo Torneo Premium"}),(0,t.jsxs)("div",{className:"flex justify-center gap-6 text-white",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[w,"/25"]}),(0,t.jsx)("div",{className:"text-sm",children:"Pregunta"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:y}),(0,t.jsx)("div",{className:"text-sm",children:"Aciertos"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:(o=Math.floor(j/60),`${o}:${(j%60).toString().padStart(2,"0")}`)}),(0,t.jsx)("div",{className:"text-sm",children:"Tiempo"})]})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-xl p-8",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:i}),n&&n.imagen&&(0,t.jsx)("div",{className:"mb-4 flex justify-center",children:(0,t.jsx)("img",{src:n.imagen,alt:"Pregunta",className:"max-w-full h-auto max-h-64 rounded-lg"})})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),onKeyPress:e=>"Enter"===e.key&&J(),placeholder:"Escribe tu respuesta aquÃ­...",className:"w-full p-4 border border-gray-300 rounded-lg text-lg focus:outline-none focus:ring-2 focus:ring-purple-500",disabled:b})}),(0,t.jsx)("div",{className:"flex gap-4",children:b?(0,t.jsx)("button",{onClick:()=>C(),className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700 transition-colors",children:x.length>=25?"Finalizar Torneo":"Siguiente Pregunta"}):(0,t.jsx)("button",{onClick:J,disabled:!m.trim(),className:"flex-1 bg-purple-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-purple-700 disabled:bg-gray-400 transition-colors",children:"Verificar Respuesta"})}),g&&(0,t.jsx)("div",{className:`mt-4 p-4 rounded-lg text-center font-semibold ${g.includes("âœ…")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"ðŸŽ¯"}),(0,t.jsx)("p",{className:"text-xl",children:"Cargando torneo..."})]})})]})})};function o(){let o,i,[l,n]=a.default.useState(!1),[d,u]=a.default.useState(!1),[c,m]=a.default.useState(!1),[p,g]=a.default.useState(!1),[f,x]=a.default.useState(!1),[h,j]=a.default.useState(null),[S,b]=a.default.useState(1),[N,y]=a.default.useState(""),[v,q]=a.default.useState((i=(o=new Date).getFullYear(),o.getMonth()+1<10?i-1:i));function k(e,t){let a=localStorage.getItem("users");if(a){let s=JSON.parse(a),r=s.findIndex(t=>t.nick===e);-1!==r&&(s[r].likes=(parseFloat(s[r].likes)||0)+t,localStorage.setItem("users",JSON.stringify(s)))}let s=localStorage.getItem("user");if(s){let a=JSON.parse(s);a.nick===e&&(a.likes=(parseFloat(a.likes)||0)+t,localStorage.setItem("user",JSON.stringify(a)))}}let[w,I]=a.default.useState(null),[O,C]=a.default.useState("1Âº Primaria"),[J,$]=a.default.useState("MatemÃ¡ticas"),[T,_]=a.default.useState(""),[P,D]=a.default.useState(null),[M,L]=a.default.useState(""),[F,E]=a.default.useState(""),[A,z]=a.default.useState(""),[G,U]=a.default.useState(300),[R,B]=a.default.useState(!1);a.default.useEffect(()=>{let e=localStorage.getItem("currentUser")||localStorage.getItem("user");if(e)try{let t=JSON.parse(e);I(t);let a=localStorage.getItem(`premium_${t.nick}`);if(a){let e=JSON.parse(a);new Date(e.expiracion)>new Date&&g(!0)}let s="1Âº Primaria";if(t.esProfesor||"docente"===t.tipo||"Docente"===t.tipo)s="6Âº Primaria";else if(t.curso)if("string"==typeof t.curso){let e=t.curso.match(/(\d)/);if(e){let t=parseInt(e[1]);s=`${t}\xba Primaria`}}else"number"==typeof t.curso&&(s=`${t.curso}\xba Primaria`);C(s);let r=localStorage.getItem("torneo_activo_premium");if(r){let e=JSON.parse(r);j(e),x(!0)}let o=new URLSearchParams(window.location.search);"torneo"===o.get("modo")&&x(!0)}catch(e){console.error("Error cargando datos del usuario:",e)}},[]),a.default.useEffect(()=>{if(!T||R)return;if(0===G){B(!0),z("â° Tiempo agotado. No puedes responder esta pregunta. -2 likes");{let e=localStorage.getItem("user");e&&k(JSON.parse(e).nick,-2)}return}let e=setTimeout(()=>U(G-1),1e3);return()=>clearTimeout(e)},[G,T,R]);let H=a.default.useMemo(()=>{let t=1;if(O){let e=O.match(/(\d+)/);e&&(t=Number(e[1]))}let a=[];for(let s of["matematicas","lenguaje","literatura","historia","geografia","naturaleza","ingles","general","campeonato"])try{let r=e.f({"../../questions/matematicas-1primaria.json":{id:()=>21199,module:()=>e.r(21199)},"../../questions/lenguaje-1primaria.json":{id:()=>27233,module:()=>e.r(27233)},"../../questions/literatura-1primaria.json":{id:()=>51575,module:()=>e.r(51575)},"../../questions/historia-1primaria.json":{id:()=>46261,module:()=>e.r(46261)},"../../questions/geografia-1primaria.json":{id:()=>82025,module:()=>e.r(82025)},"../../questions/naturaleza-1primaria.json":{id:()=>23120,module:()=>e.r(23120)},"../../questions/ingles-1primaria.json":{id:()=>70172,module:()=>e.r(70172)},"../../questions/general-1primaria.json":{id:()=>83772,module:()=>e.r(83772)},"../../questions/campeonato-1primaria.json":{id:()=>5251,module:()=>e.r(5251)},"../../questions/matematicas-2primaria.json":{id:()=>67799,module:()=>e.r(67799)},"../../questions/matematicas-3primaria.json":{id:()=>21257,module:()=>e.r(21257)},"../../questions/matematicas-4primaria.json":{id:()=>72020,module:()=>e.r(72020)},"../../questions/matematicas-5primaria.json":{id:()=>14860,module:()=>e.r(14860)},"../../questions/matematicas-6primaria.json":{id:()=>70144,module:()=>e.r(70144)},"../../questions/lenguaje-2primaria.json":{id:()=>37978,module:()=>e.r(37978)},"../../questions/lenguaje-3primaria.json":{id:()=>57015,module:()=>e.r(57015)},"../../questions/lenguaje-4primaria.json":{id:()=>69654,module:()=>e.r(69654)},"../../questions/lenguaje-5primaria.json":{id:()=>8154,module:()=>e.r(8154)},"../../questions/lenguaje-6primaria.json":{id:()=>37629,module:()=>e.r(37629)},"../../questions/literatura-2primaria.json":{id:()=>20023,module:()=>e.r(20023)},"../../questions/literatura-3primaria.json":{id:()=>53193,module:()=>e.r(53193)},"../../questions/literatura-4primaria.json":{id:()=>23792,module:()=>e.r(23792)},"../../questions/literatura-5primaria.json":{id:()=>74722,module:()=>e.r(74722)},"../../questions/literatura-6primaria.json":{id:()=>33449,module:()=>e.r(33449)},"../../questions/historia-2primaria.json":{id:()=>34709,module:()=>e.r(34709)},"../../questions/historia-3primaria.json":{id:()=>23680,module:()=>e.r(23680)},"../../questions/historia-4primaria.json":{id:()=>64972,module:()=>e.r(64972)},"../../questions/historia-5primaria.json":{id:()=>83935,module:()=>e.r(83935)},"../../questions/historia-6primaria.json":{id:()=>91854,module:()=>e.r(91854)},"../../questions/geografia-2primaria.json":{id:()=>90537,module:()=>e.r(90537)},"../../questions/geografia-3primaria.json":{id:()=>29241,module:()=>e.r(29241)},"../../questions/geografia-4primaria.json":{id:()=>53988,module:()=>e.r(53988)},"../../questions/geografia-5primaria.json":{id:()=>4473,module:()=>e.r(4473)},"../../questions/geografia-6primaria.json":{id:()=>3058,module:()=>e.r(3058)},"../../questions/naturaleza-2primaria.json":{id:()=>55129,module:()=>e.r(55129)},"../../questions/naturaleza-3primaria.json":{id:()=>75042,module:()=>e.r(75042)},"../../questions/naturaleza-4primaria.json":{id:()=>88552,module:()=>e.r(88552)},"../../questions/naturaleza-5primaria.json":{id:()=>90648,module:()=>e.r(90648)},"../../questions/naturaleza-6primaria.json":{id:()=>96073,module:()=>e.r(96073)},"../../questions/ingles-2primaria.json":{id:()=>17176,module:()=>e.r(17176)},"../../questions/ingles-3primaria.json":{id:()=>66252,module:()=>e.r(66252)},"../../questions/ingles-4primaria.json":{id:()=>8874,module:()=>e.r(8874)},"../../questions/ingles-5primaria.json":{id:()=>54850,module:()=>e.r(54850)},"../../questions/ingles-6primaria.json":{id:()=>5802,module:()=>e.r(5802)},"../../questions/general-2primaria.json":{id:()=>13725,module:()=>e.r(13725)},"../../questions/general-3primaria.json":{id:()=>98958,module:()=>e.r(98958)},"../../questions/general-4primaria.json":{id:()=>83846,module:()=>e.r(83846)},"../../questions/general-5primaria.json":{id:()=>60450,module:()=>e.r(60450)},"../../questions/general-6primaria.json":{id:()=>31390,module:()=>e.r(31390)},"../../questions/campeonato-2primaria.json":{id:()=>31668,module:()=>e.r(31668)},"../../questions/campeonato-3primaria.json":{id:()=>85700,module:()=>e.r(85700)},"../../questions/campeonato-4primaria.json":{id:()=>8433,module:()=>e.r(8433)},"../../questions/campeonato-5primaria.json":{id:()=>59447,module:()=>e.r(59447)},"../../questions/campeonato-6primaria.json":{id:()=>6959,module:()=>e.r(6959)}})(`../../questions/${s}-${t}primaria.json`);a=a.concat(r)}catch{}return a},[O]),K=a.default.useMemo(()=>"General"===J?H:H.filter(e=>e.categoria===J),[H,J]),[Y,V]=a.default.useState([]);return(Object.entries(function(e){let t=`campeonato_individual_t${e}`,a=JSON.parse(localStorage.getItem(t)||"{}"),s=localStorage.getItem("users");if(!s)return{};let r=JSON.parse(s).filter(e=>"Docente"===e.tipo),o={};return r.forEach(e=>{a[e.nick]&&(o[e.nick]=a[e.nick])}),Object.fromEntries(Object.entries(o).sort((e,t)=>t[1]-e[1]).slice(0,25))}(v)).map(([e,a])=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"border p-2",children:e}),(0,t.jsx)("td",{className:"border p-2",children:a})]},e)),c)?(0,t.jsx)(r,{userGrade:parseInt(O)||1,onTournamentComplete:(e,t)=>{if(h&&w){fetch("/api/estadisticas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:w.nick,tipo:"competiciones_premium_participaciones",puntos:1})}).catch(console.error),fetch("/api/estadisticas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:w.nick,tipo:"competiciones_premium_puntuacion",puntos:t})}).catch(console.error);let a=localStorage.getItem("torneos_premium");if(a){let s=JSON.parse(a).map(a=>{if(a.id===h.torneoId){let s=a.resultados||[];return s.push({nick:w.nick,aciertos:e,puntuacion:t}),s.sort((e,t)=>t.puntuacion-e.puntuacion),a.id.includes("torneo-mensual")&&s[0].nick===w.nick&&fetch("/api/estadisticas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:w.nick,tipo:"competiciones_premium_victorias",puntos:1})}).catch(console.error),fetch("/api/torneos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a.id,resultados:s,estado:new Date>=new Date(a.fechaFin)?"finalizado":a.estado,ganador:s.length>0?s[0].nick:void 0})}).catch(console.error),{...a,resultados:s,estado:new Date>=new Date(a.fechaFin)?"finalizado":a.estado,ganador:s.length>0?s[0].nick:void 0}}return a});localStorage.setItem("torneos_premium",JSON.stringify(s))}localStorage.removeItem("torneo_activo_premium"),alert(`\xa1Torneo completado!

Aciertos: ${e}/25
Puntuaci\xf3n total: ${t} puntos

Los resultados se han guardado. \xa1Buen trabajo!`),window.location.href="/torneos-premium"}}}):(0,t.jsxs)("div",{className:"min-h-screen bg-green-100 p-8 flex flex-col items-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Aprende con Pipo"}),(0,t.jsxs)("div",{className:"flex items-stretch mx-auto",style:{transform:"translateX(-80px)"},children:[(0,t.jsx)("img",{src:"/trofeo16.jpg",alt:"Trofeo 16",className:"h-40 object-contain mr-4"}),(0,t.jsx)("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-md p-8 flex flex-col gap-6 mx-auto",children:l?(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(s.default,{userGrade:S,userSchool:N}),(0,t.jsx)("button",{className:"bg-gray-500 text-white px-4 py-2 rounded mt-4",onClick:()=>n(!1),children:"Salir de competiciÃ³n"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg border-2 border-blue-200 mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"ðŸ›¡ï¸ Sistema Anti-Trampa Activo"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-semibold text-blue-700",children:"ðŸ‘¤ Usuario:"}),(0,t.jsx)("span",{className:"ml-2 text-gray-800",children:w?.nick||"No detectado"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-semibold text-blue-700",children:"ðŸŽ“ Curso detectado:"}),(0,t.jsx)("span",{className:"ml-2 text-gray-800 font-semibold",children:O})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-semibold text-blue-700",children:"ðŸ« Centro:"}),(0,t.jsx)("span",{className:"ml-2 text-gray-800",children:w?.centro||"No asignado"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-semibold text-blue-700",children:"ðŸ‘¥ Tipo:"}),(0,t.jsx)("span",{className:"ml-2 text-gray-800",children:w?.esProfesor||w?.tipo==="docente"||w?.tipo==="Docente"?"Docente":"Estudiante"})]})]}),(0,t.jsxs)("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:[(0,t.jsxs)("p",{className:"text-xs text-yellow-800",children:["ðŸ”’ ",(0,t.jsx)("strong",{children:"Solo podrÃ¡s responder preguntas de tu nivel"})," para garantizar puntuaciones justas."]}),(w?.esProfesor||w?.tipo==="docente"||w?.tipo==="Docente")&&(0,t.jsxs)("p",{className:"text-xs text-orange-800 mt-2",children:["ðŸ‘©â€ðŸ« ",(0,t.jsx)("strong",{children:"Modo Docente:"})," Preguntas de 6Âº curso y puntuaciÃ³n reducida al 50% para equilibrar la dificultad."]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-center",children:[(0,t.jsx)("label",{className:"font-semibold",children:"Asignatura:"}),(0,t.jsx)("select",{className:"border rounded px-2 py-1",value:J,onChange:e=>$(e.target.value),children:["Naturaleza","MatemÃ¡ticas","Lenguaje","Literatura","InglÃ©s","GeografÃ­a","Historia","General","Campeonato"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["(Curso fijo: ",(0,t.jsx)("strong",{children:O}),")"]})]}),(0,t.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mt-4",onClick:function(){if(0===K.length){_(""),D(null),L(""),z("No hay preguntas para esta asignatura."),B(!1),U(300),V([]);return}let e=K.filter(e=>!Y.includes(e.pregunta));if(0===e.length){_(""),D(null),L(""),z("Â¡Has respondido todas las preguntas disponibles!"),B(!0),U(300),V([]);return}let t=Math.floor(Math.random()*e.length),a=e[t];_(a.pregunta),D(a),L(a.respuesta),E(""),z(""),B(!1),U(300),V([...Y,a.pregunta])},children:"Generar pregunta"}),(0,t.jsx)("button",{className:"bg-orange-500 text-white px-4 py-2 rounded mt-4 self-center",onClick:()=>{let e=1,t="";{let a=localStorage.getItem("user");if(a){let s=JSON.parse(a),r=1;if(s.curso)if("string"==typeof s.curso){let e=s.curso.match(/(\d)/);e&&(r=Number(e[1]))}else"number"==typeof s.curso&&(r=s.curso);!isNaN(r)&&r>=1&&r<=6&&(e=r),s.centro&&(t=s.centro)}}n(!0),b(e),y(t)},children:"Modo competiciÃ³n"}),p&&(0,t.jsx)("button",{className:"bg-purple-500 text-white px-4 py-2 rounded mt-4 self-center",onClick:()=>{m(!0)},children:"Modo torneo"}),T&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("div",{className:"font-semibold mb-2",children:T}),(0,t.jsxs)("div",{className:"font-bold text-lg mb-2",children:["â° Tiempo: ",Math.floor(G/60),":",(G%60).toString().padStart(2,"0")," min"]}),(0,t.jsx)("input",{type:"text",className:"border rounded px-2 py-1 w-full mb-2",value:F,onChange:e=>E(e.target.value),placeholder:"Escribe tu respuesta aquÃ­",disabled:R}),(0,t.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded",onClick:function(){if(R)return;let e=0,t=w?.esProfesor||w?.tipo==="docente"||w?.tipo==="Docente",a=t?.5:1;function s(e){return e.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g,"").trim()}let r=s(F)===s(M);if(B(!0),r){if(G>120){let s=+a;z(`\xa1Correcto! ðŸŽ‰ +${s} like${1!==s?"s":""}${t?" (Docente: 50% puntos)":""}`),e=s}else{let s=.5*a;z(`\xa1Correcto! ðŸŽ‰ +${s} likes${t?" (Docente: 50% puntos)":""}`),e=s}{let e=localStorage.getItem("user"),t=localStorage.getItem("users");if(e&&t){let a=JSON.parse(e),s=`acertadas_${a.nick}`,r=parseInt(localStorage.getItem(s)||"0",10);if(localStorage.setItem(s,String(r+1)),P&&P.categoria){let e=P.categoria.toLowerCase(),t=`${{matemÃ¡ticas:"matematicas",historia:"historia",geografÃ­a:"geografia",literatura:"literatura",inglÃ©s:"ingles",naturaleza:"naturaleza",lenguaje:"lenguaje",general:"general"}[e]||e}_${a.nick}`,s=parseInt(localStorage.getItem(t)||"0",10);localStorage.setItem(t,String(s+1))}let o=JSON.parse(t),i=o.findIndex(e=>e.nick===a.nick);-1!==i&&(o[i].preguntasAcertadas=(o[i].preguntasAcertadas||0)+1,localStorage.setItem("users",JSON.stringify(o)))}}}else{if(G>120){let s=-.5*a;z(`Incorrecto. La respuesta era: ${M} ${s} likes${t?" (Docente: 50% puntos)":""}`),e=s}else{let s=-1*a;z(`Incorrecto. La respuesta era: ${M} ${s} like${1!==Math.abs(s)?"s":""}${t?" (Docente: 50% puntos)":""}`),e=s}{let e=localStorage.getItem("user"),t=localStorage.getItem("users");if(e&&t){let a=JSON.parse(e),s=JSON.parse(t),r=s.findIndex(e=>e.nick===a.nick);-1!==r&&(s[r].preguntasFalladas=(s[r].preguntasFalladas||0)+1,localStorage.setItem("users",JSON.stringify(s)))}}}{let t=localStorage.getItem("user");t&&k(JSON.parse(t).nick,e)}},disabled:R,children:"Comprobar respuesta"}),A&&(0,t.jsx)("div",{className:"mt-2 font-bold",children:A})]}),A&&!T&&(0,t.jsx)("div",{className:"mt-2 font-bold text-red-600",children:A})]})}),(0,t.jsx)("img",{src:"/logo-pipo.jpg",alt:"Logo Pipo",className:"h-40 object-contain ml-4"})]})]})}e.s(["default",()=>o],96938)}]);