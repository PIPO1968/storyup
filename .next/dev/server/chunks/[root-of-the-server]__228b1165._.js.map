{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/StoryUp.es%20-%20copia%20-%20copia/src/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nconst pool = new Pool({\r\n    connectionString: process.env.DATABASE_URL,\r\n});\r\n\r\nexport default pool;"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IAClB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC9C;uCAEe","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/StoryUp.es%20-%20copia%20-%20copia/src/app/api/premium/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport pool from '@/lib/db';\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const nick = searchParams.get('nick');\r\n\r\n        if (!nick) {\r\n            return NextResponse.json({ error: 'Nick required' }, { status: 400 });\r\n        }\r\n\r\n        // Crear tabla si no existe\r\n        await pool.query(`\r\n      CREATE TABLE IF NOT EXISTS premium (\r\n        id SERIAL PRIMARY KEY,\r\n        nick VARCHAR(255) UNIQUE NOT NULL,\r\n        expiracion TIMESTAMP NOT NULL,\r\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n      )\r\n    `);\r\n\r\n        const result = await pool.query('SELECT * FROM premium WHERE nick = $1', [nick]);\r\n        if (result.rows.length > 0) {\r\n            const premium = result.rows[0];\r\n            const isActive = new Date(premium.expiracion) > new Date();\r\n            return NextResponse.json({ isActive, expiracion: premium.expiracion });\r\n        } else {\r\n            return NextResponse.json({ isActive: false });\r\n        }\r\n    } catch (error) {\r\n        console.error('Error fetching premium:', error);\r\n        return NextResponse.json({ error: 'Error fetching premium' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const { nick, expiracion } = await request.json();\r\n\r\n        // Crear tabla si no existe\r\n        await pool.query(`\r\n      CREATE TABLE IF NOT EXISTS premium (\r\n        id SERIAL PRIMARY KEY,\r\n        nick VARCHAR(255) UNIQUE NOT NULL,\r\n        expiracion TIMESTAMP NOT NULL,\r\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n      )\r\n    `);\r\n\r\n        const result = await pool.query(\r\n            'INSERT INTO premium (nick, expiracion) VALUES ($1, $2) ON CONFLICT (nick) DO UPDATE SET expiracion = EXCLUDED.expiracion RETURNING *',\r\n            [nick, expiracion]\r\n        );\r\n\r\n        return NextResponse.json(result.rows[0]);\r\n    } catch (error) {\r\n        console.error('Error setting premium:', error);\r\n        return NextResponse.json({ error: 'Error setting premium' }, { status: 500 });\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC1C,IAAI;QACA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,OAAO,aAAa,GAAG,CAAC;QAE9B,IAAI,CAAC,MAAM;YACP,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,2BAA2B;QAC3B,MAAM,6HAAI,CAAC,KAAK,CAAC,CAAC;;;;;;;IAOtB,CAAC;QAEG,MAAM,SAAS,MAAM,6HAAI,CAAC,KAAK,CAAC,yCAAyC;YAAC;SAAK;QAC/E,IAAI,OAAO,IAAI,CAAC,MAAM,GAAG,GAAG;YACxB,MAAM,UAAU,OAAO,IAAI,CAAC,EAAE;YAC9B,MAAM,WAAW,IAAI,KAAK,QAAQ,UAAU,IAAI,IAAI;YACpD,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE;gBAAU,YAAY,QAAQ,UAAU;YAAC;QACxE,OAAO;YACH,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,UAAU;YAAM;QAC/C;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAChF;AACJ;AAEO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE/C,2BAA2B;QAC3B,MAAM,6HAAI,CAAC,KAAK,CAAC,CAAC;;;;;;;IAOtB,CAAC;QAEG,MAAM,SAAS,MAAM,6HAAI,CAAC,KAAK,CAC3B,wIACA;YAAC;YAAM;SAAW;QAGtB,OAAO,gJAAY,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,EAAE;IAC3C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ","debugId":null}}]
}